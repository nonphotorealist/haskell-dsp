<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!--Rendered using the Haskell Html Library v0.2-->
<HTML
><HEAD
  ><TITLE
    >DSP.Estimation.Frequency.PerMax</TITLE
    ><LINK HREF = "haddock.css" REL = "stylesheet" TYPE = "text/css"
    ></HEAD
  ><BODY
  ><TABLE CLASS = "vanilla" CELLSPACING = "0" CELLPADDING = "0"
    ><TR
      ><TD CLASS = "topbar"
	><TABLE CLASS = "vanilla" CELLSPACING = "0" CELLPADDING = "0"
	  ><TR
	    ><TD
	      ><IMG SRC = "haskell_icon.gif" WIDTH = "16" HEIGHT = "16" ALT = " "
		></TD
	      ><TD CLASS = "title"
	      >Haskell DSP Library</TD
	      ><TD CLASS = "topbut"
	      ><A HREF = "http://haskelldsp.sourceforge.net/DSP/Estimation/Frequency/PerMax.hs"
		>Source code</A
		></TD
	      ><TD CLASS = "topbut"
	      ><A HREF = "DSP.Estimation.Frequency.html"
		>Parent</A
		></TD
	      ><TD CLASS = "topbut"
	      ><A HREF = "index.html"
		>Contents</A
		></TD
	      ><TD CLASS = "topbut"
	      ><A HREF = "doc-index.html"
		>Index</A
		></TD
	      ></TR
	    ></TABLE
	  ></TD
	></TR
      ><TR
      ><TD CLASS = "modulebar"
	><TABLE CLASS = "vanilla" CELLSPACING = "0" CELLPADDING = "0"
	  ><TR
	    ><TD
	      ><FONT SIZE = "6"
		>DSP.Estimation.Frequency.PerMax</FONT
		></TD
	      ><TD ALIGN = "right"
	      ><TABLE CLASS = "narrow" CELLSPACING = "0" CELLPADDING = "0"
		><TR
		  ><TD CLASS = "infohead"
		    >Portability</TD
		    ><TD CLASS = "infoval"
		    >  portable</TD
		    ></TR
		  ><TR
		  ><TD CLASS = "infohead"
		    >Stability</TD
		    ><TD CLASS = "infoval"
		    >  experimental</TD
		    ></TR
		  ><TR
		  ><TD CLASS = "infohead"
		    >Maintainer</TD
		    ><TD CLASS = "infoval"
		    >  m.p.donadio@ieee.org</TD
		    ></TR
		  ></TABLE
		></TD
	      ></TR
	    ></TABLE
	  ></TD
	></TR
      ><TR
      ><TD CLASS = "s15"
	></TD
	></TR
      ><TR
      ><TD
	></TD
	></TR
      ><TR
      ><TD CLASS = "s15"
	></TD
	></TR
      ><TR
      ><TD CLASS = "section1"
	>Description</TD
	></TR
      ><TR
      ><TD CLASS = "doc"
	><P
	  > This module implements an algorithm to maximize the peak value of a
 DFT/FFT.  It is based off an aticle by Mark Sullivan from Personal
 Engineering Magazine.</P
	  ><P
	  > Maximizes</P
	  ><PRE
	  >S(w) = 1/N * sum(k=0,N-1) |x[k] * e^(-jwk)|^2</PRE
	  ><P
	  > which is equivalent to solving</P
	  ><PRE
	  >S'(w) = Im{X(w) * ~Y(w)} = 0</PRE
	  ><P
	  > where</P
	  ><P
	  > <TT
	    >X(w) =         sum(k=0,N-1) (x[k] * e^(-jwk))</TT
	    >
 <TT
	    >Y(w) = X'(w) = sum(k=0,N-1) (k * x[k] * e^(-jwk))</TT
	    ></P
	  ><P
	  > This algorithm used the bisection method for finding the zero of a
 function.  The search area is +- half a bin width.</P
	  ><P
	  > Regula falsi requires an additional (x,f(x)) pair which is expensive
 in this case.  Newton's method could be used but requires S''(w),
 which takes twice as long to caculate as S'(w).  Brent's method may be
 best here, but it also requires three (x,f(x)) pairs
</P
	  ></TD
	></TR
      ><TR
      ><TD CLASS = "s15"
	></TD
	></TR
      ><TR
      ><TD CLASS = "section1"
	>Synopsis</TD
	></TR
      ><TR
      ><TD CLASS = "s15"
	></TD
	></TR
      ><TR
      ><TD CLASS = "body"
	><TABLE CLASS = "vanilla" CELLSPACING = "0" CELLPADDING = "0"
	  ><TR
	    ><TD CLASS = "decl"
	      ><A HREF = "#permax"
		>permax</A
		> :: (Ix a, Integral a, RealFloat b) =&gt; Array a (Complex b) -&gt; a -&gt; b</TD
	      ></TR
	    ></TABLE
	  ></TD
	></TR
      ><TR
      ><TD CLASS = "s15"
	></TD
	></TR
      ><TR
      ><TD CLASS = "section1"
	>Documentation</TD
	></TR
      ><TR
      ><TD CLASS = "s15"
	></TD
	></TR
      ><TR
      ><TD CLASS = "decl"
	><A NAME = "permax"
	  ></A
	  ><B
	  >permax</B
	  ></TD
	></TR
      ><TR
      ><TD CLASS = "body"
	><TABLE CLASS = "vanilla" CELLSPACING = "0" CELLPADDING = "0"
	  ><TR
	    ><TD CLASS = "decl"
	      >:: (Ix a, Integral a, RealFloat b)</TD
	      ><TD CLASS = "rdoc"
	      ></TD
	      ></TR
	    ><TR
	    ><TD CLASS = "decl"
	      >=&gt; Array a (Complex b)</TD
	      ><TD CLASS = "rdoc"
	      > X[k]</TD
	      ></TR
	    ><TR
	    ><TD CLASS = "decl"
	      >-&gt; a</TD
	      ><TD CLASS = "rdoc"
	      > k</TD
	      ></TR
	    ><TR
	    ><TD CLASS = "decl"
	      >-&gt; b</TD
	      ><TD CLASS = "rdoc"
	      > w</TD
	      ></TR
	    ><TR
	    ><TD CLASS = "ndoc" COLSPAN = "2"
	      > Discrete frequency periodigram maximizer</TD
	      ></TR
	    ></TABLE
	  ></TD
	></TR
      ><TR
      ><TD CLASS = "s15"
	></TD
	></TR
      ><TR
      ><TD CLASS = "botbar"
	>Produced by <A HREF = "http://www.haskell.org/haddock"
	  >Haddock</A
	  > version 0.4</TD
	></TR
      ></TABLE
    ></BODY
  ></HTML
>
